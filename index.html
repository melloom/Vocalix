<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <!-- Critical CSS fallback for mobile white screen fix -->
    <style>
      html, body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        width: 100%;
        background-color: #f9f7f3;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      }
      #root {
        min-height: 100vh;
        width: 100%;
        background-color: #f9f7f3;
      }
    </style>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <title>Echo Garden</title>
    <meta
      name="description"
      content="Echo Garden helps you capture and share meaningful voice notes."
    />
    <meta name="author" content="Echo Garden" />

    <meta property="og:title" content="Echo Garden" />
    <meta
      property="og:description"
      content="Echo Garden helps you capture and share meaningful voice notes."
    />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/placeholder.svg" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="/placeholder.svg" />
  </head>

  <body>
    <div id="root">
      <!-- Loading fallback for mobile - shows immediately while JS loads -->
      <div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; background-color: #f9f7f3; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;">
        <div style="text-align: center; padding: 20px;">
          <div style="width: 40px; height: 40px; border: 4px solid #e0e0e0; border-top-color: #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
          <p style="color: #666; font-size: 16px;">Loading Echo Garden...</p>
        </div>
      </div>
      <style>
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      </style>
    </div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
      // Track if script loaded
      window.__APP_SCRIPT_LOADED__ = false;
      
      // Fallback error handler if main script fails to load (mobile browsers)
      window.addEventListener('error', function(e) {
        console.error('[HTML] Global error caught:', e);
        // Check if it's a script loading error
        if (e.filename && (e.filename.includes('main.tsx') || e.filename.includes('.js') || e.filename.includes('.tsx'))) {
          console.error('[HTML] Script loading error:', e);
          var root = document.getElementById('root');
          if (root && !window.__APP_SCRIPT_LOADED__) {
            root.innerHTML = '<div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; background-color: #f9f7f3; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;"><div style="max-width: 400px; text-align: center;"><h1 style="font-size: 24px; margin-bottom: 16px; color: #333;">Script Error</h1><p style="color: #666; margin-bottom: 24px;">There was an error loading the app script: ' + (e.message || 'Unknown error') + '. Please check your internet connection and try again.</p><button onclick="window.location.reload()" style="padding: 12px 24px; background-color: #667eea; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer;">Refresh Page</button></div></div>';
          }
        }
      }, true);
      
      // Track unhandled promise rejections
      window.addEventListener('unhandledrejection', function(e) {
        console.error('[HTML] Unhandled promise rejection:', e.reason);
      });
      
      // Timeout fallback - if app doesn't load within 15 seconds, show error
      setTimeout(function() {
        var root = document.getElementById('root');
        // Check if still showing loading screen OR if root is empty (app didn't render)
        var stillLoading = root && (
          (root.children.length === 1 && root.querySelector('div[style*="Loading Echo Garden"]')) ||
          (root.children.length === 0 && root.innerHTML.includes('Loading Echo Garden'))
        );
        if (stillLoading) {
          console.error('[App] Timeout: App did not load within 15 seconds');
          root.innerHTML = '<div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; background-color: #f9f7f3; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;"><div style="max-width: 400px; text-align: center;"><h1 style="font-size: 24px; margin-bottom: 16px; color: #333;">Loading Taking Too Long</h1><p style="color: #666; margin-bottom: 24px;">The app is taking longer than expected to load. This might be due to a slow connection or a JavaScript error. Please check the browser console and try refreshing.</p><button onclick="window.location.reload()" style="padding: 12px 24px; background-color: #667eea; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; margin-right: 8px;">Refresh Page</button><button onclick="if(navigator.onLine){window.location.reload()}else{alert(\'You appear to be offline. Please check your internet connection.\')}" style="padding: 12px 24px; background-color: transparent; color: #667eea; border: 1px solid #667eea; border-radius: 8px; font-size: 16px; cursor: pointer;">Check Connection</button></div></div>';
        }
      }, 15000);
    </script>
  </body>
</html>
